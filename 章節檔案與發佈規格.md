# 章節檔案與發佈規格（Jekyll）

> 本文件只管「檔案格式/發佈呈現」，不管寫作風格與內容；寫作原則請見 `創作基準與需求.md`。

## 1. 章節檔案位置與命名

- 章節檔案放在：`_novels/<series>/chapter-XXX.md`
- `XXX` 為三位數補零（001、002…）。
- 系列索引頁放在：`novels/<series>/index.md`，其中 `<series>` 必須與章節 front matter 的 `series` 完全一致。

## 2. Front Matter（必填欄位）

章節頁會由 `_layouts/novel.html` 渲染，並由系列索引頁透過 `series` + `chapter` 排序列出，因此以下欄位**建議視為必填**。

### 範本

```yaml
---
title: "第12章：標題"
series: "time-echo"   # 系列 slug（用於索引頁過濾）
chapter: 12            # 整數（用於排序）
volume: 1              # 可選，但建議保留
status: "draft"       # draft | published
date: 2026-02-15       # YYYY-MM-DD
excerpt: "1–2 句摘要（單行，避免換行）"
tags: ["小說"]
---
```

### 欄位規則

- `title`
  - 建議單行。
  - 避免在引號內換行（容易造成 YAML 解析或摘要顯示異常）。

- `series`
  - 系列識別用的 slug，建議全小寫、用 `-` 分隔，例如 `star-armor`、`time-echo`。
  - 必須與 `novels/<series>/index.md` 裡的過濾條件一致（`where: "series", "..."`）。

- `chapter`
  - 必須是整數，且要和檔名 `chapter-XXX.md` 對得上。
  - 章節排序以 `chapter` 為準，不看檔名。

- `status`
  - `draft`：草稿；在預設設定下（`_config.yml` 的 `show_drafts: false`）會被索引頁與章節導覽隱藏。
  - `published`：正式發佈；會出現在索引頁與導覽。

- `date`
  - 建議使用 `YYYY-MM-DD`。
  - 目前版型只用於顯示（不影響排序）。

- `excerpt`
  - 系列索引頁會顯示 `excerpt`，建議 1–2 句、**單行**。
  - 避免用空字串或把換行包在引號內（會顯示成空摘要或造成解析混亂）。

## 3. 行尾與編碼

- 建議使用 UTF-8。
- 建議使用 LF（Unix）行尾；避免 CRLF 混入引號欄位造成多行字串。

## 4. 發佈前快速檢查

- 章號是否一致：檔名 `chapter-012.md` ↔ `chapter: 12`
- `series` 是否一致：章節 front matter ↔ `novels/<series>/index.md`
- `excerpt` 是否非空、且為單行
- 草稿是否要顯示：
  - 建議用本機覆寫設定檔 `_config.local.yml`（避免不小心把草稿公開到 GitHub Pages）。
    - 本機預覽：`bundle exec jekyll serve --config _config.yml,_config.local.yml`
    - 正式站（GitHub Pages）：維持 `_config.yml` 的 `show_drafts: false`

## 5. 本機建置（可選）

若你本機有 Ruby/Bundler，可在 repo 根目錄執行：

- 安裝依賴：`bundle install`
- 建置：`bundle exec jekyll build`
- 啟動預覽：`bundle exec jekyll serve`
